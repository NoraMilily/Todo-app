================================================================================
                    TODO APP - Руководство по установке и запуску
================================================================================

Описание проекта:
-----------------
Todo App - это веб-приложение для управления задачами (todo list) с
авторизацией пользователей, профилями и поддержкой нескольких языков.

Технологии:
- Next.js 16 (React 19)
- TypeScript
- PostgreSQL (база данных)
- Prisma ORM
- NextAuth (аутентификация)
- Tailwind CSS

================================================================================
                          ТРЕБОВАНИЯ К СИСТЕМЕ
================================================================================

Для запуска проекта необходимо установить:

1. Node.js версии 18.17 или выше
   Скачать: https://nodejs.org/
   Проверить версию: node --version

2. npm (устанавливается вместе с Node.js)
   Проверить версию: npm --version

3. Docker и Docker Compose (для запуска PostgreSQL)
   Скачать: https://www.docker.com/get-started
   Проверить: docker --version
              docker-compose --version

   АЛЬТЕРНАТИВА: Если у вас уже установлен PostgreSQL локально,
   можете использовать его вместо Docker.

4. Git (для клонирования репозитория)
   Скачать: https://git-scm.com/

================================================================================
                    ПОШАГОВАЯ ИНСТРУКЦИЯ ПО УСТАНОВКЕ
================================================================================

ШАГ 1: Получение проекта
--------------------------

ВАРИАНТ A: Клонирование существующего репозитория
--------------------------------------------------
Если проект уже есть в Git репозитории и вы хотите его склонировать:

    git clone <URL_репозитория>
    cd todo-app

Пример:
    git clone https://github.com/username/todo-app.git
    cd todo-app


ВАРИАНТ B: Работа через Fork (если нет прав на запись в основной репозиторий)
---------------------------------------------------------------------------------
Если у вас нет прав на запись в основной репозиторий, нужно сделать Fork.

1. Сделайте Fork репозитория на GitHub:
   - Откройте основной репозиторий в браузере
   - Нажмите кнопку "Fork" в правом верхнем углу
   - Выберите свой аккаунт (если нужно)
   - Дождитесь создания вашей копии репозитория

2. Склонируйте СВОЙ fork (не основной репозиторий!):

    git clone https://github.com/ВАШ_АККАУНТ/todo-app.git
    cd todo-app

   Замените ВАШ_АККАУНТ на ваш GitHub username.

3. Добавьте основной репозиторий как upstream (для получения обновлений):

    git remote add upstream https://github.com/ОСНОВНОЙ_АККАУНТ/todo-app.git

   Замените ОСНОВНОЙ_АККАУНТ на username владельца основного репозитория.

4. Проверьте remote репозитории:

    git remote -v

   Должно показать:
    origin    https://github.com/ВАШ_АККАУНТ/todo-app.git (fetch)
    origin    https://github.com/ВАШ_АККАУНТ/todo-app.git (push)
    upstream  https://github.com/ОСНОВНОЙ_АККАУНТ/todo-app.git (fetch)
    upstream  https://github.com/ОСНОВНОЙ_АККАУНТ/todo-app.git (push)

5. Создайте свою ветку для работы:

    git checkout -b ваше-имя

   Примеры:
    git checkout -b ivan-petrov
    git checkout -b feature/my-feature
    git checkout -b student-work

6. Работайте в своей ветке:
   - Делайте изменения в коде
   - Делайте commits:
     git add .
     git commit -m "Описание изменений"

7. Отправьте вашу ветку в СВОЙ fork:

    git push -u origin ваше-имя

   Пример:
    git push -u origin ivan-petrov

8. Создайте Pull Request (если нужно отправить изменения в основной репозиторий):
   - Откройте ваш fork на GitHub
   - Нажмите "Compare & pull request"
   - Заполните описание изменений
   - Отправьте PR (админ репозитория рассмотрит его)

9. Получайте обновления из основного репозитория:

    git fetch upstream
    git checkout main  # или master
    git merge upstream/main  # или upstream/master
    git checkout ваше-имя
    git merge main  # обновить вашу ветку


ВАРИАНТ C: Подключение к существующему репозиторию (если есть права на запись)
---------------------------------------------------------------------------------
Если у вас ЕСТЬ права на запись в репозиторий и вы уже сделали git init:

1. Добавьте remote репозиторий:

    git remote add origin <URL_репозитория>

   Пример:
    git remote add origin https://github.com/username/todo-app.git

2. Проверьте, что remote добавлен:

    git remote -v

3. Получите информацию о ветках:

    git fetch origin

4. Создайте свою ветку:

    git checkout -b ваше-имя

5. Сделайте первый commit:

    git commit -m "Initial commit: Todo App project"

6. Отправьте вашу ветку:

    git push -u origin ваше-имя

ВАЖНО:
- Не коммитьте файлы .env, node_modules, .next в репозиторий!
- Эти файлы уже должны быть в .gitignore
- Проверьте: git status (не должно показывать эти файлы)


ВАРИАНТ C: Если у вас уже есть папка с проектом
------------------------------------------------
Если у вас уже есть папка с проектом (не из Git):

1. Откройте папку в терминале
2. Инициализируйте Git (если еще не сделано):

    git init

3. Добавьте файлы (кроме тех, что в .gitignore):

    git add .

4. Следуйте инструкциям из ВАРИАНТА B выше


ШАГ 2: Установка зависимостей
-------------------------------
Откройте терминал в папке проекта и выполните:

    npm install

Это установит все необходимые пакеты из package.json.
Процесс может занять 2-5 минут в зависимости от скорости интернета.

Ожидаемый результат: создастся папка node_modules/ с установленными пакетами.


ШАГ 3: Настройка базы данных (PostgreSQL)
------------------------------------------

ВАРИАНТ A: Использование Docker (рекомендуется)
------------------------------------------------
Если Docker Desktop установлен и работает:

1. Запустите PostgreSQL через Docker Compose:

    docker-compose up -d

   Это создаст и запустит контейнер с PostgreSQL на порту 5432.

2. Проверьте, что контейнер запущен:

    docker ps

   Вы должны увидеть контейнер с именем "todo_app_postgres".


ВАРИАНТ B: Установка PostgreSQL вручную (Windows 10)
-----------------------------------------------------
Если Docker не установлен или не работает, используйте локальный PostgreSQL.

УСТАНОВКА POSTGRESQL:
---------------------
1. Скачайте PostgreSQL для Windows:
   https://www.postgresql.org/download/windows/
   Или используйте установщик: https://www.enterprisedb.com/downloads/postgres-postgresql-downloads

2. Запустите установщик и следуйте инструкциям:
   - Выберите все компоненты (включая pgAdmin и Command Line Tools)
   - Порт: оставьте 5432 (по умолчанию)
   - Пароль для пользователя postgres: придумайте и ЗАПОМНИТЕ его!
     (Рекомендуется: postgres, но можно любой)

3. После установки PostgreSQL должен автоматически запуститься как служба Windows.

4. Проверьте, что служба запущена:
   - Откройте "Службы" (Win+R → services.msc)
   - Найдите "postgresql-x64-XX" (где XX - версия)
   - Убедитесь, что статус "Выполняется"

СОЗДАНИЕ БАЗЫ ДАННЫХ:
---------------------
После установки PostgreSQL у вас появилась команда psql в командной строке.

1. Откройте командную строку (cmd) или PowerShell.

2. Подключитесь к PostgreSQL:

    psql -U postgres

   Введите пароль, который вы указали при установке.

   Если команда psql не найдена:
   - Добавьте PostgreSQL в PATH:
     C:\Program Files\PostgreSQL\XX\bin
     (где XX - версия, например 16)
   - Или используйте полный путь:
     "C:\Program Files\PostgreSQL\16\bin\psql.exe" -U postgres

3. В psql выполните команду для создания базы данных:

    CREATE DATABASE todo_db;

4. Проверьте, что база создана:

    \l

   Вы должны увидеть todo_db в списке баз данных.

5. Выйдите из psql:

    \q

АЛЬТЕРНАТИВНЫЙ СПОСОБ (через командную строку без входа в psql):
-----------------------------------------------------------------
Откройте командную строку и выполните:

    createdb -U postgres todo_db

Введите пароль, когда будет запрошен.

ПРОВЕРКА ПОДКЛЮЧЕНИЯ:
---------------------
Проверьте, что база данных создана и доступна:

    psql -U postgres -d todo_db -c "SELECT version();"

Если команда выполнилась успешно - база данных готова к работе!

ВАЖНО: Запомните:
- Имя пользователя: postgres (по умолчанию)
- Пароль: тот, который вы указали при установке
- Порт: 5432 (по умолчанию)
- Имя базы данных: todo_db

Эти данные понадобятся для настройки DATABASE_URL в следующем шаге.


ВАРИАНТ C: Установка Docker Desktop для Windows 10 (2018)
----------------------------------------------------------
Если вы хотите использовать Docker, но у вас Windows 10 сборки 2018 года:

ТРЕБОВАНИЯ:
-----------
- Windows 10 64-bit: Pro, Enterprise, или Education (сборка 15063 или выше)
- Включенная функция Hyper-V (для старых версий)
- Или WSL 2 (для новых версий)

УСТАНОВКА DOCKER DESKTOP:
--------------------------
1. Скачайте Docker Desktop для Windows:
   https://www.docker.com/products/docker-desktop/

2. Если у вас старая версия Windows 10 (до 1903):
   - Скачайте Docker Desktop версии 4.3.0 или старше
   - Или используйте Docker Toolbox: https://docs.docker.com/toolbox/toolbox_install_windows/

3. Запустите установщик и следуйте инструкциям.

4. После установки перезагрузите компьютер.

5. Запустите Docker Desktop из меню Пуск.

6. Дождитесь, пока Docker запустится (иконка в трее перестанет мигать).

7. Проверьте установку:

    docker --version
    docker-compose --version

РЕШЕНИЕ ПРОБЛЕМ С DOCKER:
--------------------------
ПРОБЛЕМА: "Docker Desktop requires Windows 10 Pro/Enterprise/Education"
РЕШЕНИЕ:
  - Используйте Docker Toolbox (работает на Windows 10 Home)
  - Или установите PostgreSQL вручную (ВАРИАНТ B)

ПРОБЛЕМА: "WSL 2 installation is incomplete"
РЕШЕНИЕ:
  - Обновите Windows 10 до последней версии
  - Или используйте Docker Toolbox
  - Или установите PostgreSQL вручную

ПРОБЛЕМА: Docker не запускается
РЕШЕНИЕ:
  - Проверьте, включен ли Hyper-V (для старых версий)
  - Перезагрузите компьютер
  - Запустите Docker Desktop от имени администратора
  - Используйте PostgreSQL вручную (ВАРИАНТ B) - это проще!


ШАГ 4: Настройка переменных окружения
--------------------------------------
1. Создайте файл .env в корне проекта.

   ПРОСТОЙ СПОСОБ: Скопируйте файл .env.example в .env:

   Windows (PowerShell):
   Copy-Item .env.example .env

   Windows (CMD):
   copy .env.example .env

   Linux/Mac:
   cp .env.example .env

2. Откройте файл .env и настройте переменные окружения:

   DATABASE_URL="postgresql://postgres:postgres@localhost:5432/todo_db?schema=public"

   NEXTAUTH_SECRET="ваш-секретный-ключ-для-nextauth-минимум-32-символа"

   NEXTAUTH_URL="http://localhost:3000"

   ПРИМЕЧАНИЯ:
   - Если используете Docker PostgreSQL (ВАРИАНТ A):
     DATABASE_URL="postgresql://postgres:postgres@localhost:5432/todo_db?schema=public"

   - Если используете локальный PostgreSQL (ВАРИАНТ B):
     Замените на ваши данные:
     DATABASE_URL="postgresql://postgres:ВАШ_ПАРОЛЬ@localhost:5432/todo_db?schema=public"

     Пример, если пароль "mypassword123":
     DATABASE_URL="postgresql://postgres:mypassword123@localhost:5432/todo_db?schema=public"

     ВАЖНО: Если в пароле есть специальные символы (@, #, $, и т.д.),
     закодируйте их в URL-формате:
     @ → %40
     # → %23
     $ → %24
     & → %26
     и т.д.

   - Для NEXTAUTH_SECRET сгенерируйте случайную строку (минимум 32 символа).
     Выполните в терминале:

     node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

     Скопируйте полученную строку и вставьте в NEXTAUTH_SECRET.

     Или используйте команду NextAuth (рекомендуется):
     npx auth secret

     Эта команда автоматически сгенерирует безопасный ключ.

   - NEXTAUTH_URL должен соответствовать URL, на котором запущено приложение.
     Для разработки: http://localhost:3000
     Для production: https://ваш-домен.com


ШАГ 5: Настройка Prisma
------------------------
1. Сгенерируйте Prisma Client:

    npm run prisma:generate

   Это создаст типизированный клиент для работы с базой данных.

2. Примените миграции базы данных:

    npm run prisma:migrate

   Это создаст все необходимые таблицы в базе данных (User, Todo).

   Если появится запрос на имя миграции, введите любое имя, например: "init"


ВАЖНО: Папка .next отсутствует в репозитории
----------------------------------------------
Если вы клонировали проект из GitHub, папка .next будет отсутствовать.
Это нормально! Папка .next создается автоматически при сборке проекта.

Для разработки (режим разработки):
- Папка .next создается автоматически при запуске: npm run dev
- Не нужно ничего делать вручную

Для production (режим продакшена):
- Создайте папку .next командой: npm run build
- После этого запустите: npm start

Папка .next содержит:
- Скомпилированные файлы Next.js
- Оптимизированные компоненты
- Статические ресурсы

Эта папка находится в .gitignore и не должна попадать в репозиторий,
так как она генерируется автоматически при сборке проекта.


ШАГ 6: Запуск приложения
-------------------------
1. Запустите сервер разработки:

    npm run dev

2. Откройте браузер и перейдите по адресу:

    http://localhost:3000

   Или для русского языка:
    http://localhost:3000/ru

   Или для английского:
    http://localhost:3000/en


================================================================================
                          ИСПОЛЬЗОВАНИЕ ПРИЛОЖЕНИЯ
================================================================================

Первое использование:
---------------------
1. Зарегистрируйте нового пользователя:
   - Перейдите на страницу регистрации (/ru/auth/register)
   - Введите email, username и пароль
   - Нажмите "Зарегистрироваться"

2. Войдите в систему:
   - Перейдите на страницу входа (/ru/auth/login)
   - Введите email или username и пароль
   - Нажмите "Войти"

3. Используйте приложение:
   - Добавляйте задачи на главной странице
   - Редактируйте профиль в разделе "Профиль"
   - Фильтруйте задачи по статусу (Все/Активные/Выполненные)


================================================================================
                      ПОЛЕЗНЫЕ КОМАНДЫ
================================================================================

Разработка:
-----------
npm run dev              - Запустить сервер разработки
npm run build            - Собрать проект для production
npm run start            - Запустить production версию
npm run lint             - Проверить код на ошибки

База данных:
------------
npm run prisma:generate  - Сгенерировать Prisma Client
npm run prisma:migrate   - Применить миграции
npm run prisma:studio    - Открыть Prisma Studio (GUI для БД)

Docker:
-------
docker-compose up -d     - Запустить PostgreSQL
docker-compose down      - Остановить PostgreSQL
docker-compose logs      - Посмотреть логи
docker ps                - Показать запущенные контейнеры


================================================================================
                      ВОЗМОЖНЫЕ ПРОБЛЕМЫ И РЕШЕНИЯ
================================================================================

ПРОБЛЕМА: "Cannot find module '@prisma/client'"
РЕШЕНИЕ: Выполните: npm run prisma:generate

ПРОБЛЕМА: "Error: P1001: Can't reach database server"
РЕШЕНИЕ:
  Для Docker:
  1. Проверьте, что PostgreSQL запущен: docker-compose up -d
  2. Проверьте контейнер: docker ps

  Для локального PostgreSQL:
  1. Проверьте, что служба PostgreSQL запущена:
     - Win+R → services.msc
     - Найдите "postgresql-x64-XX"
     - Статус должен быть "Выполняется"
  2. Проверьте DATABASE_URL в файле .env:
     - Правильный пароль?
     - Правильное имя базы данных (todo_db)?
     - Правильный порт (5432)?
  3. Проверьте подключение вручную:
     psql -U postgres -d todo_db
  4. Убедитесь, что порт 5432 не занят другим приложением:
     netstat -an | findstr 5432

ПРОБЛЕМА: "password authentication failed" или "FATAL: password"
РЕШЕНИЕ:
  1. Проверьте пароль в DATABASE_URL
  2. Попробуйте подключиться вручную:
     psql -U postgres
  3. Если забыли пароль, сбросьте его:
     - Откройте файл: C:\Program Files\PostgreSQL\XX\data\pg_hba.conf
     - Найдите строку: host all all 127.0.0.1/32 md5
     - Замените md5 на trust (временно!)
     - Перезапустите службу PostgreSQL
     - Подключитесь: psql -U postgres
     - Измените пароль: ALTER USER postgres PASSWORD 'новый_пароль';
     - Верните md5 обратно в pg_hba.conf
     - Перезапустите службу

ПРОБЛЕМА: "database 'todo_db' does not exist"
РЕШЕНИЕ:
  1. Создайте базу данных:
     psql -U postgres -c "CREATE DATABASE todo_db;"
  2. Или через psql:
     psql -U postgres
     CREATE DATABASE todo_db;
     \q

ПРОБЛЕМА: "Port 3000 is already in use"
РЕШЕНИЕ:
  1. Остановите другое приложение на порту 3000
  2. Или измените порт: PORT=3001 npm run dev

ПРОБЛЕМА: "Migration failed"
РЕШЕНИЕ:
  1. Убедитесь, что база данных создана
  2. Проверьте права доступа к базе данных
  3. Попробуйте сбросить миграции:
     npx prisma migrate reset (ОСТОРОЖНО: удалит все данные!)

ПРОБЛЕМА: "Module not found" или ошибки импорта
РЕШЕНИЕ:
  1. Удалите папку node_modules
  2. Удалите package-lock.json
  3. Выполните: npm install

ПРОБЛЕМА: "Папка .next отсутствует" или "Cannot find module .next"
РЕШЕНИЕ:
  Это нормально! Папка .next создается автоматически.

  Для разработки:
  - Просто запустите: npm run dev
  - Папка .next создастся автоматически

  Для production:
  - Выполните: npm run build
  - Это создаст папку .next с собранным проектом
  - Затем запустите: npm start

  ПРИМЕЧАНИЕ: Папка .next не должна быть в Git репозитории,
  она генерируется при сборке проекта.

ПРОБЛЕМА: Docker не запускается
РЕШЕНИЕ:
  1. Убедитесь, что Docker Desktop запущен
  2. Проверьте, что порт 5432 свободен
  3. Попробуйте изменить порт в docker-compose.yml


================================================================================
                      СТРУКТУРА ПРОЕКТА
================================================================================

Основные папки и файлы:

src/
  app/              - Страницы и маршруты Next.js
    [locale]/      - Страницы с поддержкой языков - маршрутизатор сайта
    actions/       - Server Actions (серверная логика)
    api/           - API маршруты
  components/      - React компоненты
  lib/             - Вспомогательные библиотеки
  i18n/            - Настройки интернационализации

prisma/
  schema.prisma    - Схема базы данных
  migrations/      - Миграции базы данных

public/
  avatars/         - Загруженные аватары пользователей

messages/
  ru.json          - Русские переводы
  en.json          - Английские переводы

.next/             - Скомпилированные файлы Next.js (создается при сборке)
                     Эта папка НЕ должна быть в Git репозитории!
                     Генерируется автоматически командой: npm run build


================================================================================
                      ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ
================================================================================

Документация проекта:
---------------------
- FRONTEND_BACKEND_EXPLANATION.md - Объяснение архитектуры
- TECHNICAL_DETAILS.md - Технические детали
- REFERENCES.md - Список литературы
- TECHNOLOGY_JUSTIFICATION.md - Обоснование выбора технологий

Полезные ссылки:
----------------
- Next.js: https://nextjs.org/docs
- Prisma: https://www.prisma.io/docs
- NextAuth: https://next-auth.js.org
- React: https://react.dev


================================================================================
                      ПОДДЕРЖКА И ВОПРОСЫ
================================================================================

Если у вас возникли проблемы:
1. Проверьте, что все зависимости установлены (npm install)
2. Убедитесь, что база данных запущена
3. Проверьте файл .env на наличие всех необходимых переменных
4. Посмотрите логи в терминале для диагностики ошибок

Для просмотра базы данных:
- Запустите: npm run prisma:studio
- Откроется веб-интерфейс для просмотра и редактирования данных


================================================================================
              ЗАПУСК ПРОЕКТА В PRODUCTION РЕЖИМЕ С NGINX
================================================================================

Этот раздел описывает, как запустить приложение в production режиме
с использованием Nginx в качестве reverse proxy.

ТРЕБОВАНИЯ:
-----------
- Установленный Nginx
- Собранное production приложение
- Запущенная база данных PostgreSQL


ШАГ 1: Подготовка production сборки
-------------------------------------
1. Убедитесь, что все зависимости установлены:

    npm install

2. Сгенерируйте Prisma Client:

    npm run prisma:generate

3. Соберите production версию приложения:

    npm run build

   Это создаст оптимизированную версию приложения в папке .next/

   ВАЖНО: Если папки .next нет - это нормально! Она создастся при сборке.
   Папка .next не должна быть в Git репозитории, она генерируется автоматически.


ШАГ 2: Настройка переменных окружения для production
-----------------------------------------------------
Создайте или обновите файл .env с production настройками:

    DATABASE_URL="postgresql://postgres:postgres@localhost:5432/todo_db?schema=public"
    NEXTAUTH_SECRET="ваш-секретный-ключ-минимум-32-символа"
    NEXTAUTH_URL="http://ваш-домен.com"  # Или http://localhost для тестирования
    NODE_ENV="production"


ШАГ 3: Установка и настройка Nginx
-----------------------------------

ВАРИАНТ A: Linux (Ubuntu/Debian)
---------------------------------
1. Установите Nginx (если не установлен):

    sudo apt update
    sudo apt install nginx

2. Скопируйте конфигурацию nginx.conf в папку sites-available:

    sudo cp nginx.conf /etc/nginx/sites-available/todo-app

3. Отредактируйте конфигурацию:

    sudo nano /etc/nginx/sites-available/todo-app

   Измените:
   - server_name на ваш домен (или оставьте localhost)
   - proxy_pass на порт, где будет работать Next.js (по умолчанию 3000)

4. Создайте символическую ссылку:

    sudo ln -s /etc/nginx/sites-available/todo-app /etc/nginx/sites-enabled/

5. Проверьте конфигурацию Nginx:

    sudo nginx -t

6. Перезапустите Nginx:

    sudo systemctl restart nginx


ВАРИАНТ B: Windows
------------------
1. Скачайте Nginx: http://nginx.org/en/download.html

2. Распакуйте архив (например, в C:\nginx)

3. Скопируйте nginx.conf в папку conf (C:\nginx\conf\todo-app.conf)

4. Откройте C:\nginx\conf\nginx.conf и добавьте в конец:

    include todo-app.conf;

5. Запустите Nginx:

    cd C:\nginx
    start nginx

   Или через командную строку от администратора:
   nginx.exe


ШАГ 4: Запуск Next.js приложения
---------------------------------

ВАРИАНТ A: Прямой запуск (для тестирования)
--------------------------------------------
1. Запустите production сервер:

    npm start

   Приложение будет доступно на http://localhost:3000

2. Nginx будет проксировать запросы с порта 80 на порт 3000


ВАРИАНТ B: Использование PM2 (рекомендуется для production)
-----------------------------------------------------------
PM2 - это менеджер процессов для Node.js приложений.

1. Установите PM2 глобально:

    npm install -g pm2

2. Создайте папку для логов:

    mkdir logs

3. Запустите приложение через PM2:

    pm2 start ecosystem.config.js

4. Сохраните конфигурацию PM2 (чтобы приложение запускалось после перезагрузки):

    pm2 save
    pm2 startup

5. Полезные команды PM2:

    pm2 list              - Список запущенных приложений
    pm2 logs todo-app     - Просмотр логов
    pm2 restart todo-app   - Перезапуск приложения
    pm2 stop todo-app      - Остановка приложения
    pm2 delete todo-app    - Удаление из PM2


ШАГ 5: Проверка работы
-----------------------
1. Убедитесь, что Next.js приложение запущено:

    # Если используете PM2:
    pm2 list

    # Если запускали напрямую:
    # Проверьте, что процесс работает на порту 3000

2. Проверьте, что Nginx запущен:

    # Linux:
    sudo systemctl status nginx

    # Windows:
    # Проверьте процессы в диспетчере задач

3. Откройте браузер и перейдите:

    http://localhost        # Если используете Nginx на порту 80
    http://localhost:3000   # Если обращаетесь напрямую к Next.js

4. Проверьте логи при ошибках:

    # Логи Nginx:
    sudo tail -f /var/log/nginx/todo-app-error.log

    # Логи PM2:
    pm2 logs todo-app


ШАГ 6: Настройка HTTPS (опционально, для production)
------------------------------------------------------
Для production рекомендуется использовать HTTPS.

1. Получите SSL сертификат (например, через Let's Encrypt):

    sudo apt install certbot python3-certbot-nginx
    sudo certbot --nginx -d ваш-домен.com

2. Или используйте самоподписанный сертификат для тестирования:

    # Создайте сертификат
    openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
      -keyout /etc/nginx/ssl/nginx.key \
      -out /etc/nginx/ssl/nginx.crt

3. Раскомментируйте секцию HTTPS в nginx.conf и укажите пути к сертификатам


ОСОБЕННОСТИ КОНФИГУРАЦИИ NGINX:
--------------------------------
- proxy_pass http://localhost:3000 - проксирует запросы к Next.js
- client_max_body_size 2M - максимальный размер загружаемых файлов (аватары)
- proxy_set_header - передает правильные заголовки для Next.js
- Кэширование статических файлов для лучшей производительности


РЕШЕНИЕ ПРОБЛЕМ С NGINX:
------------------------
ПРОБЛЕМА: "502 Bad Gateway"
РЕШЕНИЕ:
  1. Проверьте, что Next.js приложение запущено (pm2 list или проверка порта 3000)
  2. Проверьте, что в nginx.conf указан правильный порт (proxy_pass)
  3. Проверьте логи: sudo tail -f /var/log/nginx/todo-app-error.log

ПРОБЛЕМА: "Connection refused"
РЕШЕНИЕ:
  1. Убедитесь, что приложение слушает на порту 3000
  2. Проверьте файрвол (должен разрешать подключения к порту 3000)
  3. Проверьте, что NEXTAUTH_URL в .env соответствует URL, на котором доступно приложение

ПРОБЛЕМА: Статические файлы не загружаются
РЕШЕНИЕ:
  1. Проверьте права доступа к папке public/
  2. Убедитесь, что Next.js правильно собрался (npm run build)
  3. Проверьте конфигурацию location /_next/static в nginx.conf


АЛЬТЕРНАТИВНЫЙ ВАРИАНТ: Запуск без Nginx
-----------------------------------------
Если не хотите использовать Nginx, можно запустить Next.js напрямую:

1. Соберите приложение: npm run build
2. Запустите: npm start
3. Приложение будет доступно на http://localhost:3000

НО: Для production рекомендуется использовать Nginx или другой reverse proxy
для:
- Обработки статических файлов
- SSL/TLS терминации
- Балансировки нагрузки
- Сжатия ответов


================================================================================
                    РАБОТА С GIT РЕПОЗИТОРИЕМ
================================================================================

ОСНОВНЫЕ КОМАНДЫ GIT:
---------------------
Проверить статус файлов:
    git status

Добавить файлы в staging:
    git add .
    git add имя-файла

Сделать commit:
    git commit -m "Описание изменений"

Отправить изменения в репозиторий:
    git push

Получить изменения из репозитория:
    git pull

Посмотреть все ветки:
    git branch -a

Переключиться на другую ветку:
    git checkout имя-ветки

Создать новую ветку:
    git checkout -b имя-новой-ветки


ЧТО НЕ ДОЛЖНО ПОПАДАТЬ В РЕПОЗИТОРИЙ:
--------------------------------------
Следующие файлы и папки НЕ должны быть в Git (они в .gitignore):

- .env, .env.local, .env.* (файлы с секретами)
- node_modules/ (зависимости)
- .next/ (собранные файлы Next.js)
- public/avatars/* (загруженные пользователями файлы)
- *.log (логи)

Проверьте перед commit:
    git status

Если видите эти файлы - они не должны быть добавлены!


РАБОТА С ВЕТКАМИ:
-----------------
Создать свою ветку для работы:
    git checkout -b моя-ветка

Работать в своей ветке:
    # Делайте изменения в коде
    git add .
    git commit -m "Описание изменений"
    git push -u origin моя-ветка

Обновить свою ветку из main/master:
    git checkout main
    git pull
    git checkout моя-ветка
    git merge main

Отправить изменения в свою ветку:
    git push


РАБОТА С FORK (если нет прав на запись):
-----------------------------------------
Если вы работаете через Fork:

Получить обновления из основного репозитория:
    git fetch upstream
    git checkout main
    git merge upstream/main

Обновить свою рабочую ветку:
    git checkout моя-ветка
    git merge main

Отправить изменения в свой fork:
    git push origin моя-ветка

Создать Pull Request:
    1. Откройте ваш fork на GitHub
    2. Нажмите "New Pull Request"
    3. Выберите вашу ветку
    4. Заполните описание
    5. Отправьте PR


РЕШЕНИЕ ПРОБЛЕМ С GIT:
-----------------------
ПРОБЛЕМА: "fatal: remote origin already exists"
РЕШЕНИЕ:
    git remote remove origin
    git remote add origin <URL_репозитория>

ПРОБЛЕМА: "Permission denied" при push
РЕШЕНИЕ:
    - Убедитесь, что используете СВОЙ fork (origin), а не основной репозиторий
    - Проверьте: git remote -v
    - Если работаете через fork, push делайте в origin, а не в upstream
    - Если нет прав - сделайте fork репозитория на GitHub

ПРОБЛЕМА: Как получить обновления из основного репозитория при работе через fork?
РЕШЕНИЕ:
    1. Добавьте upstream (если еще не добавлен):
       git remote add upstream <URL_основного_репозитория>

    2. Получите обновления:
       git fetch upstream

    3. Обновите вашу ветку:
       git checkout main
       git merge upstream/main
       git checkout ваша-ветка
       git merge main

ПРОБЛЕМА: "error: failed to push some refs"
РЕШЕНИЕ:
    git pull origin main --rebase
    git push

ПРОБЛЕМА: "Your branch is ahead of 'origin/ваша-ветка'"
РЕШЕНИЕ:
    git push

ПРОБЛЕМА: Случайно добавили .env в Git
РЕШЕНИЕ:
    git rm --cached .env
    git commit -m "Remove .env from repository"
    git push

ПРОБЛЕМА: Конфликт при merge
РЕШЕНИЕ:
    1. Откройте файлы с конфликтами
    2. Найдите маркеры <<<<<<<, =======, >>>>>>>
    3. Разрешите конфликт вручную
    4. git add .
    5. git commit -m "Resolve merge conflict"


================================================================================
                            УДАЧИ!
================================================================================

Если всё настроено правильно, вы должны увидеть рабочее приложение
на http://localhost:3000 (или через Nginx на http://localhost)

Приятной работы с проектом!
