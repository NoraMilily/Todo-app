# Обоснование выбора технологий

## Почему важно выбирать технологии правильно?

Выбор технологий влияет на:
- Скорость разработки
- Легкость поддержки кода
- Безопасность приложения
- Производительность
- Возможность масштабирования

В этом разделе объясняется, почему были выбраны именно эти технологии для данного проекта.

## Frontend Framework: Next.js

### Что такое Next.js?

Next.js - это фреймворк, построенный на React, который добавляет возможности для создания полноценных веб-приложений.

### Почему Next.js?

**1. Server Actions**

Next.js предоставляет Server Actions - способ выполнять серверный код напрямую из клиентских компонентов.

**Без Server Actions (традиционный подход):**
```typescript
// Нужно создавать отдельные API маршруты
// Frontend
fetch('/api/todos', {
  method: 'POST',
  body: JSON.stringify({ text: 'Задача' })
});

// Backend - отдельный файл
export async function POST(request: Request) {
  const data = await request.json();
  // Обработка...
}
```

**С Server Actions:**
```typescript
// Просто вызываем функцию
<form action={addTodoAction}>
  <input name="text" />
</form>
```

**Преимущества:**
- Меньше кода
- Автоматическая типизация
- Меньше ошибок
- Проще для начинающих

**2. Встроенная оптимизация**

Next.js автоматически:
- Оптимизирует изображения
- Разделяет код на части (code splitting)
- Предзагружает страницы
- Кэширует данные

**3. TypeScript из коробки**

Next.js отлично работает с TypeScript, что помогает находить ошибки до запуска приложения.

**4. App Router**

Современный способ организации маршрутов, который делает код более понятным и структурированным.

### Альтернативы и почему они не подошли

**React без Next.js:**
- Пришлось бы настраивать сборку вручную
- Нет Server Actions
- Больше конфигурации

**Vue.js / Angular:**
- Отличные фреймворки, но команда выбрала React экосистему
- Next.js - стандарт для React приложений

## Backend: Next.js Server Actions

### Почему Server Actions вместо отдельного API?

**Традиционный подход (REST API):**
```
Frontend → HTTP запрос → Express/Fastify → База данных
```

**Server Actions подход:**
```
Frontend → Вызов функции → Server Action → База данных
```

### Преимущества Server Actions

**1. Единая кодовая база**

Frontend и backend находятся в одном проекте, что упрощает:
- Обмен типами данных
- Рефакторинг
- Понимание кода

**2. Автоматическая типизация**

TypeScript автоматически проверяет типы между frontend и backend.

**3. Меньше шаблонного кода**

Не нужно создавать отдельные файлы для каждого API endpoint.

**4. Безопасность из коробки**

Next.js автоматически защищает Server Actions от CSRF атак.

### Когда Server Actions не подходят?

Server Actions отлично подходят для:
- CRUD операций (создание, чтение, обновление, удаление)
- Аутентификации
- Работы с формами

Но если нужен публичный API для сторонних приложений, лучше использовать традиционные API маршруты.

## База данных: PostgreSQL

### Что такое PostgreSQL?

PostgreSQL - это реляционная база данных. Это означает, что данные хранятся в таблицах со связями между ними.

### Почему PostgreSQL?

**1. Надежность**

PostgreSQL - одна из самых надежных баз данных:
- Гарантирует целостность данных
- Поддерживает транзакции
- Имеет защиту от потери данных

**2. Гибкость**

Поддерживает:
- Различные типы данных
- Сложные запросы
- Расширения для дополнительных возможностей

**3. Бесплатность и открытый исходный код**

Не нужно платить за лицензию.

**4. Популярность**

Много документации, примеров и поддержки сообщества.

### Альтернативы

**SQLite:**
- Проще для начинающих
- Но не подходит для production с множеством пользователей
- Нет поддержки одновременных подключений

**MySQL:**
- Хорошая альтернатива
- Но PostgreSQL имеет лучшую поддержку сложных типов данных

**MongoDB (NoSQL):**
- Подходит для других типов проектов
- Но для этого проекта реляционная модель подходит лучше

## ORM: Prisma

### Что такое ORM?

ORM (Object-Relational Mapping) - это инструмент, который позволяет работать с базой данных, используя код на языке программирования вместо SQL.

### Что такое Prisma?

Prisma - это современный ORM для TypeScript/JavaScript, который делает работу с базой данных простой и безопасной.

### Почему Prisma был выбран?

**1. Type Safety (Типобезопасность)**

Prisma автоматически генерирует TypeScript типы на основе схемы базы данных.

**Пример:**

```typescript
// Prisma автоматически знает структуру Todo
const todo = await prisma.todo.findUnique({
  where: { id: "123" }
});

// TypeScript знает, что todo имеет поля:
// todo.id, todo.text, todo.completed, todo.dueDate, todo.priority
```

Если вы попытаетесь обратиться к несуществующему полю, TypeScript сразу покажет ошибку.

**2. Безопасность от SQL-инъекций**

**Опасный способ (чистый SQL):**
```typescript
// ОПАСНО! Уязвимо для SQL-инъекций
const query = `SELECT * FROM "Todo" WHERE text = '${userInput}'`;
```

Если `userInput` содержит злонамеренный код, база данных может быть повреждена.

**Безопасный способ (Prisma):**
```typescript
// БЕЗОПАСНО! Prisma автоматически экранирует данные
await prisma.todo.findMany({
  where: { text: userInput }
});
```

Prisma автоматически защищает от SQL-инъекций.

**3. Читаемость кода**

**С чистым SQL:**
```sql
INSERT INTO "Todo" (text, "dueDate", priority, "userId", "completed")
VALUES ('Купить молоко', '2026-01-30', 'MEDIUM', 'user123', false);
```

**С Prisma:**
```typescript
await prisma.todo.create({
  data: {
    text: "Купить молоко",
    dueDate: new Date("2026-01-30"),
    priority: "MEDIUM",
    userId: "user123",
    completed: false,
  },
});
```

Код с Prisma легче читать и понимать.

**4. Миграции базы данных**

Prisma позволяет управлять изменениями схемы базы данных через миграции.

**Пример:**

Вы хотите добавить поле `dueDate` к таблице `Todo`:

1. Изменяете схему в `schema.prisma`:
```prisma
model Todo {
  dueDate DateTime
}
```

2. Создаете миграцию:
```bash
npx prisma migrate dev --name add_due_date
```

3. Prisma автоматически:
   - Создает SQL миграцию
   - Применяет её к базе данных
   - Обновляет Prisma Client

**Без Prisma** пришлось бы:
- Писать SQL вручную
- Помнить, какие миграции уже применены
- Рисковать ошибками

**5. Prisma Studio**

Визуальный редактор базы данных:
```bash
npm run prisma:studio
```

Позволяет просматривать и редактировать данные без знания SQL.

**6. Автодополнение в IDE**

При работе с Prisma ваша IDE (VS Code, WebStorm) автоматически предлагает:
- Доступные поля
- Доступные методы
- Правильные типы данных

Это ускоряет разработку и уменьшает количество ошибок.

### Сравнение с другими ORM

**TypeORM:**
- Более сложная конфигурация
- Меньше типобезопасности
- Больше шаблонного кода

**Sequelize:**
- Старая библиотека
- Меньше поддержки TypeScript
- Более сложный синтаксис

**Drizzle:**
- Более новый ORM
- Хорошая альтернатива Prisma
- Но Prisma имеет больше документации и примеров

### Преимущества Prisma для этого проекта

1. **Быстрая разработка** - меньше времени на написание кода для работы с БД
2. **Меньше ошибок** - TypeScript проверяет типы автоматически
3. **Безопасность** - защита от SQL-инъекций из коробки
4. **Легкая поддержка** - код понятен даже новичкам
5. **Миграции** - безопасное изменение структуры базы данных

## Аутентификация: NextAuth

### Что такое NextAuth?

NextAuth - это библиотека для аутентификации в Next.js приложениях.

### Почему NextAuth?

**1. Простота использования**

```typescript
// Минимальная настройка
export const { auth } = NextAuth({
  providers: [Credentials({ ... })],
});
```

**2. Безопасность из коробки**

- Защита от CSRF атак
- Безопасное хранение сессий
- Защита от атак перебора паролей

**3. Гибкость**

Поддерживает различные провайдеры:
- Credentials (email/password)
- OAuth (Google, GitHub и т.д.)
- Можно легко добавить новые

**4. JWT сессии**

Использует JWT токены для хранения сессий, что делает приложение масштабируемым.

### Альтернативы

**Auth.js (ранее NextAuth.js):**
- Это та же библиотека, просто переименованная

**Firebase Auth:**
- Хороший вариант для больших проектов
- Но требует внешнего сервиса
- Для этого проекта избыточен

**Самописная аутентификация:**
- Возможно, но требует много работы
- Легко сделать ошибки в безопасности
- NextAuth решает все проблемы безопасности

## Валидация данных: Zod

### Что такое Zod?

Zod - это библиотека для проверки и валидации данных в TypeScript.

### Почему Zod?

**1. TypeScript интеграция**

Zod автоматически выводит TypeScript типы из схем валидации.

**Пример:**

```typescript
const schema = z.object({
  email: z.string().email(),
  age: z.number().min(18),
});

// TypeScript автоматически знает тип
type User = z.infer<typeof schema>;
// User = { email: string, age: number }
```

**2. Читаемые сообщения об ошибках**

```typescript
const result = schema.safeParse(data);
if (!result.success) {
  console.log(result.error.errors);
  // Понятные сообщения об ошибках
}
```

**3. Композиция схем**

Можно создавать сложные схемы из простых:

```typescript
const baseSchema = z.object({
  text: z.string().min(1),
});

const todoSchema = baseSchema.extend({
  dueDate: z.date(),
  priority: z.enum(["IMPORTANT", "MEDIUM", "EASY"]),
});
```

**4. Использование в проекте**

В проекте Zod используется для:
- Валидации данных форм
- Проверки данных от пользователя
- Обеспечения безопасности

### Альтернативы

**Yup:**
- Похожая библиотека
- Но Zod лучше интегрируется с TypeScript

**Joi:**
- Старая библиотека
- Меньше поддержки TypeScript

## Стилизация: Tailwind CSS

### Что такое Tailwind CSS?

Tailwind CSS - это утилитарный CSS фреймворк. Вместо написания собственных CSS классов, вы используете готовые утилиты.

### Почему Tailwind CSS?

**1. Быстрая разработка**

```html
<!-- Вместо написания CSS -->
<div class="flex items-center gap-4 p-4 bg-white rounded-lg">
```

**2. Консистентность**

Все стили следуют единой системе размеров и цветов.

**3. Меньше CSS кода**

Не нужно писать отдельные CSS файлы для каждого компонента.

**4. Оптимизация**

Tailwind автоматически удаляет неиспользуемые стили при сборке.

### Альтернативы

**Обычный CSS:**
- Больше работы
- Сложнее поддерживать

**CSS Modules:**
- Хороший вариант
- Но требует больше кода

**Styled Components:**
- Отличный вариант для больших проектов
- Но добавляет сложность

## Интернационализация: next-intl

### Что такое next-intl?

next-intl - это библиотека для поддержки нескольких языков в Next.js приложениях.

### Почему next-intl?

**1. Простота использования**

```typescript
const t = useTranslations("Todos");
<h1>{t("title")}</h1>
```

**2. TypeScript поддержка**

Автоматическая проверка ключей переводов.

**3. Интеграция с Next.js**

Работает из коробки с App Router.

**4. В проекте**

Поддерживает русский и английский языки, легко добавить новые.

## Хеширование паролей: bcryptjs

### Что такое bcryptjs?

bcryptjs - это библиотека для безопасного хранения паролей.

### Почему bcryptjs?

**1. Безопасность**

- Одностороннее хеширование (нельзя восстановить пароль)
- Автоматическое добавление "соли" (salt)
- Медленное хеширование (защита от перебора)

**2. Простота использования**

```typescript
// Хеширование пароля
const hash = await hashPassword("мой_пароль");

// Проверка пароля
const isValid = await verifyPassword("мой_пароль", hash);
```

**3. Стандарт индустрии**

bcrypt - стандартный алгоритм для хеширования паролей.

### Почему не хранить пароли в открытом виде?

Если база данных будет взломана, злоумышленник не сможет узнать пароли пользователей, так как они хранятся в виде хешей.

## Резюме выбора технологий

Каждая технология была выбрана по конкретным причинам:

- **Next.js** - современный фреймворк с Server Actions
- **PostgreSQL** - надежная и бесплатная база данных
- **Prisma** - безопасная и типобезопасная работа с БД
- **NextAuth** - простая и безопасная аутентификация
- **Zod** - валидация данных с TypeScript поддержкой
- **Tailwind CSS** - быстрая стилизация
- **next-intl** - поддержка нескольких языков
- **bcryptjs** - безопасное хранение паролей

Все эти технологии работают вместе, создавая современное, безопасное и поддерживаемое приложение.
